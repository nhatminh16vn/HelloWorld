<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flawless Fact or Fiction Game</title>
    <style>
        :root {
            --primary: #6e8efb;
            --secondary: #a777e3;
            --correct: #4CAF50;
            --incorrect: #F44336;
            --next-btn: #FFC107;
            --text-light: #ffffff;
            --text-dark: #333333;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--text-light);
            text-align: center;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            line-height: 1.6;
        }
        
        .container {
            background: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            padding: 30px;
            max-width: 600px;
            width: 95%;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        h1 {
            margin: 0 0 20px;
            font-size: clamp(1.8rem, 4vw, 2.5rem);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            background: linear-gradient(to right, #ff8a00, #e52e71);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .progress-container {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(to right, #ff8a00, #e52e71);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .fact-display {
            font-size: clamp(1.2rem, 3vw, 1.5rem);
            margin: 20px 0;
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid var(--primary);
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 15px 0;
        }
        
        button {
            padding: 12px 25px;
            font-size: 1.1em;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            min-width: 120px;
            outline: none;
            user-select: none;
        }
        
        #fact-btn {
            background: var(--correct);
            color: white;
        }
        
        #fiction-btn {
            background: var(--incorrect);
            color: white;
        }
        
        button:hover:not(:disabled) {
            transform: scale(1.05);
            filter: brightness(1.1);
        }
        
        button:active:not(:disabled) {
            transform: scale(0.98);
        }
        
        button:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .score-container {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-top: 20px;
            font-size: 1.2em;
        }
        
        .feedback {
            font-size: clamp(1.1rem, 3vw, 1.3rem);
            font-weight: bold;
            margin: 15px 0;
            min-height: 24px;
            transition: all 0.3s;
        }
        
        .correct {
            color: var(--correct);
            text-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
        }
        
        .incorrect {
            color: var(--incorrect);
            text-shadow: 0 0 10px rgba(244, 67, 54, 0.5);
        }
        
        #next-btn {
            background: var(--next-btn);
            color: var(--text-dark);
            display: none;
            margin: 20px auto 0;
        }
        
        .explanation {
            font-size: clamp(0.9rem, 2.5vw, 1rem);
            margin-top: 10px;
            font-style: italic;
            opacity: 0.9;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease, margin 0.3s ease;
            text-align: left;
            background: rgba(0, 0, 0, 0.3);
            padding: 0 15px;
            border-radius: 8px;
        }
        
        .show-explanation {
            max-height: 300px;
            margin-top: 15px;
            padding: 15px;
        }
        
        .category-selector {
            margin-bottom: 20px;
            width: 100%;
        }
        
        select {
            padding: 8px 15px;
            border-radius: 20px;
            border: none;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-weight: bold;
            width: 100%;
            max-width: 300px;
            cursor: pointer;
            outline: none;
        }
        
        select option {
            background: rgba(0, 0, 0, 0.8);
            color: white;
        }
        
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #f00;
            border-radius: 50%;
            pointer-events: none;
            z-index: 100;
        }
        
        .game-over {
            font-size: 1.5em;
            margin: 20px 0;
        }
        
        .restart-btn {
            background: var(--primary);
            color: white;
            margin-top: 20px;
        }
        
        .error-message {
            color: #ff4444;
            font-weight: bold;
            margin: 10px 0;
        }
        
        @media (max-width: 500px) {
            .container {
                padding: 20px;
            }
            
            .buttons {
                flex-direction: column;
                gap: 10px;
            }
            
            button {
                width: 100%;
            }
            
            .fact-display {
                padding: 15px;
                min-height: 100px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚ú® Fact or Fiction? ‚ú®</h1>
        
        <div class="category-selector">
            <select id="category-select">
                <option value="all">All Categories</option>
                <option value="general">General Knowledge</option>
                <option value="science">Science</option>
                <option value="history">History</option>
                <option value="animals">Animals</option>
                <option value="geography">Geography</option>
            </select>
        </div>
        
        <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>
        
        <div class="score-container">
            <div>Score: <span id="score">0</span></div>
            <div>Question: <span id="question-count">1</span>/<span id="total-questions">0</span></div>
        </div>
        
        <div class="fact-display" id="fact-display">Loading game...</div>
        
        <div class="feedback" id="feedback"></div>
        <div class="error-message" id="error-message"></div>
        <div class="explanation" id="explanation"></div>
        
        <div class="buttons">
            <button id="fact-btn">Fact ‚úÖ</button>
            <button id="fiction-btn">Fiction ‚ùå</button>
        </div>
        
        <button id="next-btn">Next Question ‚û°</button>
        <button id="restart-btn" class="restart-btn" style="display: none;">Play Again üîÑ</button>
    </div>

    <script>
        // Enhanced game data with categories and explanations
        const gameData = {
            general: [
                { 
                    statement: "Honey never spoils. Archaeologists have found edible honey in ancient Egyptian tombs.", 
                    answer: "fact",
                    explanation: "Honey's low moisture content and acidic pH make it inhospitable to bacteria. Archaeologists have indeed found 3,000-year-old honey that's still edible!"
                },
                { 
                    statement: "The Great Wall of China is the only man-made structure visible from space.", 
                    answer: "fiction",
                    explanation: "This is a common myth. Many large human-made structures are visible from low Earth orbit, but the Great Wall isn't particularly visible to the naked eye."
                }
            ],
            science: [
                { 
                    statement: "Bananas are berries, but strawberries aren't.", 
                    answer: "fact",
                    explanation: "Botanically, berries develop from a single ovary and typically contain multiple seeds. Bananas qualify, while strawberries develop from multiple ovaries."
                },
                { 
                    statement: "The human body has five senses.", 
                    answer: "fiction",
                    explanation: "Humans have at least 9 senses, including balance (equilibrioception), temperature (thermoception), and pain (nociception)."
                }
            ],
            history: [
                { 
                    statement: "Cleopatra lived closer to the invention of the iPhone than to the building of the pyramids.", 
                    answer: "fact",
                    explanation: "The pyramids were built around 2560 BCE, Cleopatra lived around 30 BCE (2,530 years later), and the iPhone debuted in 2007 (2,037 years after Cleopatra)."
                },
                { 
                    statement: "The Titanic was the deadliest ship disaster in history.", 
                    answer: "fiction",
                    explanation: "While tragic (1,500+ deaths), the Wilhelm Gustloff sinking in 1945 killed about 9,400 people, making it the deadliest maritime disaster."
                }
            ],
            animals: [
                { 
                    statement: "A group of flamingos is called a 'flamboyance'.", 
                    answer: "fact",
                    explanation: "This colorful term fits these vibrant birds perfectly! Other great animal group names include a 'murder' of crows and a 'parliament' of owls."
                },
                { 
                    statement: "Bats are blind.", 
                    answer: "fiction",
                    explanation: "While bats use echolocation to navigate, they can see quite well. In fact, many species have excellent night vision."
                }
            ],
            geography: [
                { 
                    statement: "The Eiffel Tower grows taller in the summer due to heat expansion.", 
                    answer: "fact",
                    explanation: "Iron expands when heated! The tower can grow up to 6 inches (15 cm) taller on hot days."
                },
                { 
                    statement: "Canada is the largest country in the world by land area.", 
                    answer: "fiction",
                    explanation: "Russia is the largest (17.1 million km¬≤), followed by Canada (9.98 million km¬≤). Canada is larger than China and the US though!"
                }
            ]
        };

        // Game state management
        const gameState = {
            currentQuestions: [],
            currentIndex: 0,
            score: 0,
            isActive: false,
            selectedCategory: 'all',
            answered: false
        };

        // DOM elements
        const elements = {
            factDisplay: document.getElementById('fact-display'),
            factBtn: document.getElementById('fact-btn'),
            fictionBtn: document.getElementById('fiction-btn'),
            nextBtn: document.getElementById('next-btn'),
            restartBtn: document.getElementById('restart-btn'),
            scoreDisplay: document.getElementById('score'),
            feedbackDisplay: document.getElementById('feedback'),
            errorDisplay: document.getElementById('error-message'),
            explanationDisplay: document.getElementById('explanation'),
            questionCountDisplay: document.getElementById('question-count'),
            totalQuestionsDisplay: document.getElementById('total-questions'),
            progressBar: document.getElementById('progress-bar'),
            categorySelect: document.getElementById('category-select')
        };

        // Initialize the game
        function initGame() {
            try {
                // Validate DOM elements
                if (!validateElements()) {
                    throw new Error('Critical DOM elements missing');
                }

                // Event listeners with error handling
                safelyAddListener(elements.factBtn, 'click', () => handleAnswer('fact'));
                safelyAddListener(elements.fictionBtn, 'click', () => handleAnswer('fiction'));
                safelyAddListener(elements.nextBtn, 'click', nextQuestion);
                safelyAddListener(elements.restartBtn, 'click', startGame);
                safelyAddListener(elements.categorySelect, 'change', handleCategoryChange);
                
                // Initial game setup
                startGame();
            } catch (error) {
                showError(`Initialization failed: ${error.message}`);
            }
        }

        function validateElements() {
            for (const [key, element] of Object.entries(elements)) {
                if (!element) {
                    console.error(`Missing element: ${key}`);
                    return false;
                }
            }
            return true;
        }

        function safelyAddListener(element, event, handler) {
            if (!element) {
                console.error(`Cannot add listener to missing element`);
                return;
            }
            element.addEventListener(event, handler);
        }

        function handleCategoryChange(e) {
            try {
                gameState.selectedCategory = e.target.value;
                startGame();
            } catch (error) {
                showError(`Category change failed: ${error.message}`);
            }
        }

        function startGame() {
            try {
                // Reset game state
                gameState.currentIndex = 0;
                gameState.score = 0;
                gameState.isActive = true;
                gameState.answered = false;
                
                // Reset UI
                elements.scoreDisplay.textContent = gameState.score;
                elements.factBtn.style.display = 'block';
                elements.fictionBtn.style.display = 'block';
                elements.nextBtn.style.display = 'none';
                elements.restartBtn.style.display = 'none';
                elements.errorDisplay.textContent = '';
                elements.factBtn.disabled = false;
                elements.fictionBtn.disabled = false;
                
                // Load questions
                loadQuestions();
                
                // Load first question
                if (gameState.currentQuestions.length > 0) {
                    loadQuestion();
                } else {
                    showError("No questions available for this category.");
                    gameState.isActive = false;
                    elements.factBtn.style.display = 'none';
                    elements.fictionBtn.style.display = 'none';
                }
            } catch (error) {
                showError(`Game start failed: ${error.message}`);
            }
        }

        function loadQuestions() {
            try {
                if (gameState.selectedCategory === 'all') {
                    gameState.currentQuestions = Object.values(gameData).flat();
                } else if (gameData[gameState.selectedCategory]) {
                    gameState.currentQuestions = [...gameData[gameState.selectedCategory]];
                } else {
                    gameState.currentQuestions = [];
                }
                
                // Shuffle questions
                gameState.currentQuestions = shuffleArray(gameState.currentQuestions);
                elements.totalQuestionsDisplay.textContent = gameState.currentQuestions.length;
            } catch (error) {
                showError(`Failed to load questions: ${error.message}`);
                gameState.currentQuestions = [];
            }
        }

        function shuffleArray(array) {
            try {
                const newArray = [...array];
                for (let i = newArray.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
                }
                return newArray;
            } catch (error) {
                showError(`Shuffle failed: ${error.message}`);
                return array; // Return unshuffled as fallback
            }
        }

        function loadQuestion() {
            try {
                if (!gameState.isActive || gameState.currentIndex >= gameState.currentQuestions.length) {
                    endGame();
                    return;
                }
                
                // Update UI
                elements.questionCountDisplay.textContent = gameState.currentIndex + 1;
                elements.progressBar.style.width = `${((gameState.currentIndex + 1) / gameState.currentQuestions.length) * 100}%`;
                
                // Set question
                elements.factDisplay.textContent = gameState.currentQuestions[gameState.currentIndex].statement;
                elements.feedbackDisplay.textContent = '';
                elements.feedbackDisplay.className = 'feedback';
                elements.explanationDisplay.textContent = '';
                elements.explanationDisplay.className = 'explanation';
                elements.nextBtn.style.display = 'none';
                elements.factBtn.disabled = false;
                elements.fictionBtn.disabled = false;
                gameState.answered = false;
            } catch (error) {
                showError(`Failed to load question: ${error.message}`);
            }
        }

        function handleAnswer(guess) {
            try {
                if (!gameState.isActive || gameState.answered) return;
                
                gameState.answered = true;
                const correctAnswer = gameState.currentQuestions[gameState.currentIndex].answer;
                elements.factBtn.disabled = true;
                elements.fictionBtn.disabled = true;
                elements.nextBtn.style.display = 'block';
                
                // Show explanation
                elements.explanationDisplay.textContent = 
                    gameState.currentQuestions[gameState.currentIndex].explanation || "No explanation available.";
                elements.explanationDisplay.classList.add('show-explanation');
                
                if (guess === correctAnswer) {
                    gameState.score++;
                    elements.scoreDisplay.textContent = gameState.score;
                    elements.feedbackDisplay.textContent = "Correct! üéâ";
                    elements.feedbackDisplay.className = 'feedback correct';
                    createConfetti();
                } else {
                    elements.feedbackDisplay.textContent = `Wrong! It's ${correctAnswer === 'fact' ? 'a FACT' : 'FICTION'}.`;
                    elements.feedbackDisplay.className = 'feedback incorrect';
                }
            } catch (error) {
                showError(`Answer processing failed: ${error.message}`);
            }
        }

        function nextQuestion() {
            try {
                gameState.currentIndex++;
                if (gameState.currentIndex < gameState.currentQuestions.length) {
                    loadQuestion();
                } else {
                    endGame();
                }
            } catch (error) {
                showError(`Question transition failed: ${error.message}`);
            }
        }

        function endGame() {
            try {
                gameState.isActive = false;
                elements.factDisplay.innerHTML = `<div class="game-over">Game Over!<br>Your final score: ${gameState.score}/${gameState.currentQuestions.length}</div>`;
                elements.feedbackDisplay.textContent = '';
                elements.explanationDisplay.textContent = '';
                elements.explanationDisplay.className = 'explanation';
                elements.nextBtn.style.display = 'none';
                elements.factBtn.style.display = 'none';
                elements.fictionBtn.style.display = 'none';
                elements.restartBtn.style.display = 'block';
                
                if (gameState.score === gameState.currentQuestions.length) {
                    createConfetti(true);
                    elements.factDisplay.innerHTML += `<div style="margin-top: 10px;">Perfect score! üèÜ</div>`;
                }
            } catch (error) {
                showError(`Game end failed: ${error.message}`);
            }
        }

        function createConfetti(intense = false) {
            try {
                const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff'];
                const container = document.querySelector('.container');
                
                const confettiCount = intense ? 100 : 20;
                
                for (let i = 0; i < confettiCount; i++) {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.left = `${Math.random() * 100}%`;
                    confetti.style.top = '-10px';
                    container.appendChild(confetti);
                    
                    const animationDuration = Math.random() * 3 + 2;
                    
                    const animation = confetti.animate([
                        { transform: `translate(0, 0) rotate(0deg)`, opacity: 1 },
                        { transform: `translate(${Math.random() * 200 - 100}px, ${window.innerHeight}px) rotate(${Math.random() * 360}deg)`, opacity: 0 }
                    ], {
                        duration: animationDuration * 1000,
                        easing: 'cubic-bezier(0.1, 0.8, 0.9, 1)'
                    });
                    
                    animation.onfinish = () => {
                        try {
                            confetti.remove();
                        } catch (e) {
                            console.error('Confetti removal failed', e);
                        }
                    };
                }
            } catch (error) {
                console.error('Confetti failed', error);
            }
        }

        function showError(message) {
            console.error(message);
            if (elements.errorDisplay) {
                elements.errorDisplay.textContent = message;
            }
        }

        // Start the game when page is fully loaded
        if (document.readyState === 'complete') {
            initGame();
        } else {
            window.addEventListener('load', initGame);
        }
    </script>
</body>
</html>
