<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trò chơi đá bóng 1D</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
        }
        #gameContainer {
            position: relative;
            width: 100%;
            height: 100px;
            background-color: green;
            margin-top: 50px;
        }
        #player {
            position: absolute;
            width: 20px;
            height: 40px;
            background-color: blue;
            bottom: 0;
            left: 20%;
        }
        #ball {
            position: absolute;
            width: 15px;
            height: 15px;
            background-color: white;
            border-radius: 50%;
            bottom: 40px;
            left: 25%;
        }
        #opponent {
            position: absolute;
            width: 20px;
            height: 40px;
            background-color: red;
            bottom: 0;
            right: 20%;
        }
        #goalLeft, #goalRight {
            position: absolute;
            width: 5px;
            height: 30px;
            background-color: white;
            bottom: 0;
        }
        #goalLeft {
            left: 0;
        }
        #goalRight {
            right: 0;
        }
        #score {
            text-align: center;
            font-size: 24px;
            margin-top: 20px;
        }
        #controls {
            text-align: center;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div id="score">Bạn: 0 - 0 : Đối phương</div>
    <div id="gameContainer">
        <div id="goalLeft"></div>
        <div id="goalRight"></div>
        <div id="player"></div>
        <div id="ball"></div>
        <div id="opponent"></div>
    </div>
    <div id="controls">
        <button id="moveLeft">Trái (A)</button>
        <button id="kick">Đá (Space)</button>
        <button id="moveRight">Phải (D)</button>
    </div>

    <script>
        // Các phần tử game
        const player = document.getElementById('player');
        const ball = document.getElementById('ball');
        const opponent = document.getElementById('opponent');
        const scoreElement = document.getElementById('score');
        const gameContainer = document.getElementById('gameContainer');
        
        // Kích thước sân
        const fieldWidth = gameContainer.offsetWidth;
        
        // Vị trí ban đầu
        let playerPos = fieldWidth * 0.2;
        let ballPos = fieldWidth * 0.25;
        let opponentPos = fieldWidth * 0.8;
        
        // Vận tốc
        let ballSpeed = 0;
        let opponentSpeed = 0;
        
        // Trạng thái bóng
        let ballOwner = null; // 'player', 'opponent', hoặc null
        
        // Điểm số
        let playerScore = 0;
        let opponentScore = 0;
        
        // Cập nhật vị trí các phần tử
        function updatePositions() {
            player.style.left = playerPos + 'px';
            ball.style.left = ballPos + 'px';
            opponent.style.left = opponentPos + 'px';
        }
        
        // Kiểm tra va chạm
        function checkCollision(objectPos, objectWidth) {
            return Math.abs(ballPos - objectPos) < objectWidth/2 + 7.5;
        }
        
        // AI đơn giản cho đối thủ
        function updateOpponentAI() {
            if (ballOwner === 'opponent') {
                // Đối thủ có bóng, di chuyển về phía khung thành của bạn
                if (opponentPos > fieldWidth * 0.1) {
                    opponentSpeed = -2;
                } else {
                    // Đối thủ đá bóng
                    ballSpeed = 10;
                    ballOwner = null;
                }
            } else {
                // Đối thủ đuổi theo bóng
                if (ballPos > opponentPos + 20) {
                    opponentSpeed = 2;
                } else if (ballPos < opponentPos - 20) {
                    opponentSpeed = -2;
                } else {
                    opponentSpeed = 0;
                    if (checkCollision(opponentPos, 20) {
                        ballOwner = 'opponent';
                        ballSpeed = 0;
                    }
                }
            }
            
            opponentPos += opponentSpeed;
            opponentPos = Math.max(0, Math.min(fieldWidth - 20, opponentPos));
        }
        
        // Cập nhật trò chơi
        function update() {
            // Di chuyển bóng
            if (ballOwner === 'player') {
                ballPos = playerPos + 25;
            } else if (ballOwner === 'opponent') {
                ballPos = opponentPos - 5;
            } else {
                ballPos += ballSpeed;
                
                // Kiểm tra va chạm với biên
                if (ballPos < 0) {
                    // Đối phương ghi bàn
                    opponentScore++;
                    resetAfterGoal();
                    return;
                }
                
                if (ballPos > fieldWidth) {
                    // Bạn ghi bàn
                    playerScore++;
                    resetAfterGoal();
                    return;
                }
                
                // Kiểm tra va chạm với người chơi
                if (checkCollision(playerPos, 20)) {
                    if (isKicking) {
                        // Đá bóng
                        ballSpeed = 10;
                        ballOwner = null;
                        isKicking = false;
                    } else {
                        // Nhận bóng
                        ballOwner = 'player';
                        ballSpeed = 0;
                    }
                }
                
                // Kiểm tra va chạm với đối thủ
                if (checkCollision(opponentPos, 20) {
                    ballOwner = 'opponent';
                    ballSpeed = 0;
                }
            }
            
            // Cập nhật AI đối thủ
            updateOpponentAI();
            
            // Cập nhật hiển thị
            updatePositions();
            scoreElement.textContent = `Bạn: ${playerScore} - ${opponentScore} : Đối phương`;
            
            // Tiếp tục vòng lặp game
            requestAnimationFrame(update);
        }
        
        // Reset sau khi ghi bàn
        function resetAfterGoal() {
            playerPos = fieldWidth * 0.2;
            ballPos = fieldWidth * 0.5;
            opponentPos = fieldWidth * 0.8;
            ballSpeed = 0;
            ballOwner = null;
            updatePositions();
            scoreElement.textContent = `Bạn: ${playerScore} - ${opponentScore} : Đối phương`;
        }
        
        // Điều khiển
        let playerSpeed = 0;
        let isKicking = false;
        
        document.addEventListener('keydown', (e) => {
            switch (e.key.toLowerCase()) {
                case 'a':
                    playerSpeed = -5;
                    break;
                case 'd':
                    playerSpeed = 5;
                    break;
                case ' ':
                    if (ballOwner === 'player') {
                        isKicking = true;
                    }
                    break;
            }
        });
        
        document.addEventListener('keyup', (e) => {
            switch (e.key.toLowerCase()) {
                case 'a':
                case 'd':
                    playerSpeed = 0;
                    break;
                case ' ':
                    isKicking = false;
                    break;
            }
        });
        
        // Điều khiển bằng nút
        document.getElementById('moveLeft').addEventListener('mousedown', () => playerSpeed = -5);
        document.getElementById('moveLeft').addEventListener('mouseup', () => playerSpeed = 0);
        document.getElementById('moveRight').addEventListener('mousedown', () => playerSpeed = 5);
        document.getElementById('moveRight').addEventListener('mouseup', () => playerSpeed = 0);
        document.getElementById('kick').addEventListener('mousedown', () => {
            if (ballOwner === 'player') isKicking = true;
        });
        document.getElementById('kick').addEventListener('mouseup', () => isKicking = false);
        
        // Di chuyển người chơi
        function movePlayer() {
            playerPos += playerSpeed;
            playerPos = Math.max(0, Math.min(fieldWidth - 20, playerPos));
            requestAnimationFrame(movePlayer);
        }
        
        // Bắt đầu trò chơi
        updatePositions();
        movePlayer();
        update();
    </script>
</body>
</html>
